<?xml version="1.0" encoding="UTF-8"?>
<sqlMap namespace="MenuPublish">
	<sql id="SelectMenuPublishList">
		 <![CDATA[
		    SELECT ID,
		       PUBNUM_NUM,
		       PUBLISH_DATE,
		       PUBLISH_HOUR,
		       PUBLISH_STATE
			FROM   MENU_PUBLISH
			WHERE  ( 1 = 1 )
			<#if id?exists && id!="">
			  And ID=:id
			</#if>
			<#if pubnumNum?exists && pubnumNum!="">
			  And PUBNUM_NUM=:pubnumNum
			</#if>
			<#if publishDate?exists && publishDate!="">
			  And PUBLISH_DATE=:publishDate
			</#if>
			<#if publishHour?exists && publishHour!="">
			  And PUBLISH_HOUR=:publishHour
			</#if>
			<#if publishState?exists && publishState!="">
			  And PUBLISH_STATE=:publishState
			</#if>
			<#if oderbyField?exists && oderbyField!="">
			  Order by ${oderbyField}
			</#if>
			<#if oderbyAscOrDesc?exists && oderbyAscOrDesc!="">
			  ${oderbyAscOrDesc}	
			</#if>
		]]>
	</sql>
		<sql id="SelectCompanyMenuPublishList">
		 <![CDATA[
		    SELECT Max(ID) id,
		       PUBNUM_NUM
			FROM   MENU_PUBLISH
			WHERE  PUBLISH_STATE in(0,2) and DATE_FORMAT(PUBLISH_DATE, '%Y-%m-%d')<=sysdate() and PUBLISH_HOUR<=EXTRACT(HOUR from curtime())	
			<#if pubnumNum?exists && pubnumNum!="">
			 	AND PUBNUM_NUM=:pubnumNum 
			</#if>
			GROUP BY PUBNUM_NUM
		]]>
	</sql>
	<sql id="DeleteMenuPublish" >
		<![CDATA[
			DELETE FROM MENU_PUBLISH
			WHERE  ID = :id
		]]>
	</sql>
	<sql id="AddMenuPublish">
		<![CDATA[
			INSERT INTO MENU_PUBLISH
			            (
		       PUBNUM_NUM,
		       PUBLISH_DATE,
		       PUBLISH_HOUR,
		       PUBLISH_STATE)
			VALUES      ( 
			              :pubnumNum,
			              :publishDate,
			              :publishHour,
			              :publishState) 
         ]]>
	</sql>
	<sql id="UpdateMenuPublish">
		<![CDATA[
			UPDATE MENU_PUBLISH
			SET    
				   <#if pubnumNum?exists && pubnumNum!="">
				   PUBNUM_NUM = :pubnumNum,
				   </#if>
				   <#if publishDate?exists && publishDate!="">
			       PUBLISH_DATE = :publishDate,
			       </#if>
			       <#if publishHour?exists && publishHour!="">
			       PUBLISH_HOUR = :publishHour,
			       </#if>
			       <#if publishState?exists && publishState!="">
			       PUBLISH_STATE = :publishState
			       </#if>
			WHERE  ID = :id
		]]>
	</sql>
</sqlMap>